<mat-card class="button">
  <a mat-raised-button color="accent" routerLink="/products" >Listado de productos</a>
</mat-card>

<mat-tab-group class="mat-tab">
  <mat-tab label="Información de producto">
    <form
    class="needs-validation"
    novalidate
    [formGroup]="productForm"
    (ngSubmit)="onSubmit()"
    >
    <mat-card>
      <mat-card-content>
        <img [src]="imagen" placeholder="Imágen del producto" style="max-width:100%;width:auto;height:auto;"/>
      </mat-card-content>
    </mat-card>
    <mat-card>
        <mat-card-content>
          <section>
            <mat-form-field class="inputSmall" appearance="fill">
              <mat-label>Estado</mat-label>
              <mat-select formControlName="Estado" placeholder="Selecciona un estado del producto" [(value)]="selectedState">
                <mat-option *ngFor="let state of productStatus" [value]="state.value">
                  {{state.viewValue}}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field class="inputSmall" hintLabel="Max. 30 caracteres" appearance="fill">
              <mat-label>SKU</mat-label>
              <input formControlName="Sku" matInput #input1 maxlength="30" [ngClass]="{'is-invalid': isValidField('Sku')}">
              <mat-hint align="end">{{input1.value?.length || 0}}/30</mat-hint>
              <div class="invalid-feedback">
                <span class="span-errors" *ngIf="productForm.get('Sku').errors?.required">
                    El nombre es obligatorio.
                </span>
              </div>
            </mat-form-field>
            <mat-form-field class="inputBig" hintLabel="Max. 150 caracteres" appearance="fill">
              <mat-label>Url</mat-label>
              <input formControlName="Url" matInput #input2 maxlength="150" [ngClass]="{'is-invalid': isValidField('Url')}">
              <mat-hint align="end">{{input2.value?.length || 0}}/150</mat-hint>
              <div class="invalid-feedback">
                <span class="span-errors" *ngIf="productForm.get('Url').errors?.required">
                    El nombre es obligatorio.
                </span>
                <span class="span-errors" *ngIf="productForm.get('Url').errors?.minlength">
                  Longitud mínima es de
                  {{ customersForm.get("Url").errors?.minlength?.requiredLength }}
                  caracteres.
                </span>
                <span class="span-errors" *ngIf="productForm.get('Url').errors?.pattern">
                  Caracteres no válidos.
                </span>
              </div>
            </mat-form-field>
            <mat-form-field class="inputBig" hintLabel="Max. 150 caracteres" appearance="fill">
              <mat-label>Articulo</mat-label>
              <input formControlName="Articulo" matInput #input3 maxlength="150" [ngClass]="{'is-invalid': isValidField('Articulo')}">
              <mat-hint align="end">{{input3.value?.length || 0}}/150</mat-hint>
              <div class="invalid-feedback">
                <span class="span-errors" *ngIf="productForm.get('Articulo').errors?.required">
                    El nombre es obligatorio.
                </span>
                <span class="span-errors" *ngIf="productForm.get('Articulo').errors?.minlength">
                  Longitud mínima es de
                  {{ customersForm.get("Articulo").errors?.minlength?.requiredLength }}
                  caracteres.
                </span>
              </div>
            </mat-form-field>
          </section>
        </mat-card-content>
      </mat-card>
      <mat-card>
        <mat-card-content>
          <section>
            <mat-form-field class="inputSmall" appearance="fill">
              <mat-label>Tipo de IVA</mat-label>
              <mat-select formControlName="IVA" placeholder="Selecciona IVA" [(value)]="selectedVat">
                <mat-option *ngFor="let vat of typeVat" [value]="vat.value">
                  {{vat.viewValue}}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field class="inputSmall" appearance="fill">
              <mat-label>Precio</mat-label>
              <input formControlName="Precio" min="0" matInput [ngClass]="{'is-invalid': isValidField('Precio')}">
              <div class="invalid-feedback">
                <span class="span-errors" *ngIf="productForm.get('Precio').errors?.required">
                    Precio obligatorio (defecto 0).
                </span>
                <span class="span-errors" *ngIf="productForm.get('Precio').errors?.pattern">
                    Caracteres no válidos.
                </span>
                <span class="span-errors" *ngIf="productForm.get('Precio').errors?.min">
                    El valor mínimo es 0.
                </span>
              </div>
            </mat-form-field>
            <mat-form-field class="inputSmall" appearance="fill">
              <mat-label>Precio oferta</mat-label>
              <input formControlName="PrecioRebajado" min="0" matInput [ngClass]="{'is-invalid': isValidField('PrecioRebajado')}">
              <div class="invalid-feedback">
                <span class="span-errors" *ngIf="productForm.get('PrecioRebajado').errors?.required">
                    Precio obligatorio (defecto 0).
                </span>
                <span class="span-errors" *ngIf="productForm.get('PrecioRebajado').errors?.pattern">
                  Caracteres no válidos.
                </span>
                <span class="span-errors" *ngIf="productForm.get('PrecioRebajado').errors?.min">
                  El valor mínimo es 0.
                </span>
              </div>
            </mat-form-field>
            <mat-form-field class="inputSmall" appearance="fill">
              <mat-label>Precio de coste</mat-label>
              <input formControlName="PCoste" min="0" matInput [ngClass]="{'is-invalid': isValidField('PCoste')}">
              <div class="invalid-feedback">
                <span class="span-errors" *ngIf="productForm.get('PCoste').errors?.required">
                  Precio obligatorio (defecto 0).
                </span>
                <span class="span-errors" *ngIf="productForm.get('PCoste').errors?.pattern">
                  Caracteres no válidos.
                </span>
                <span class="span-errors" *ngIf="productForm.get('PCoste').errors?.min">
                  El valor mínimo es 0.
                </span>
              </div>
            </mat-form-field>

            <mat-form-field class="inputSmall" appearance="fill">
              <mat-label>Stock</mat-label>
              <input formControlName="Stock" min="0" matInput [ngClass]="{'is-invalid': isValidField('Stock')}">
              <div class="invalid-feedback">
                <span class="span-errors" *ngIf="productForm.get('Stock').errors?.pattern">
                  Caracteres no válidos.
                </span>
                <span class="span-errors" *ngIf="productForm.get('Stock').errors?.min">
                  El valor mínimo es 0.
                </span>
              </div>
            </mat-form-field>
          </section>
        </mat-card-content>
      </mat-card>
      <mat-card>
        <mat-card-content>
          <section>
            <mat-form-field class="inputSmall" appearance="fill">
              <mat-label>Referencia proveedor</mat-label>
              <input formControlName="refproveedor" matInput>
            </mat-form-field>  
            <mat-form-field class="inputMedium" appearance="fill">
              <mat-label>Proveedor</mat-label>
              <mat-select formControlName="IdProveedor" placeholder="Selecciona un proveedor" [(value)]="selectedProve">
                <mat-option *ngFor="let supp of supplier" [value]="supp.term_id">
                  {{supp.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field class="inputMedium" appearance="fill">
              <mat-label>Subcategorias</mat-label>
              <mat-select formControlName="IdSubCategoria" (selectionChange)="onChangeSubcategory($event)" placeholder="Selecciona una subcategoría" [(value)]="selectedSubcat">
                <mat-option *ngFor="let subcat of subcategory" [value]="subcat.ter_term_id">
                  {{subcat.ter_name}}
                </mat-option>

              </mat-select>
            </mat-form-field>



          </section>
        </mat-card-content>
      </mat-card>
      <mat-card>
        <mat-card-content>
          <section>
            <mat-form-field class="textarea-full-width" appearance="fill">
              <mat-label>Descripción del producto</mat-label>
              <textarea formControlName="DescCorta" matInput
               cdkTextareaAutosize
               cdkAutosizeMinRows="1"
               cdkAutosizeMaxRows="50">
              </textarea>
            </mat-form-field>
          </section>
        </mat-card-content>
      </mat-card>
      <mat-card class="button">
        <button mat-raised-button color="primary"
          type="submit"
          class="btn btn-primary btn-lg"
          [disabled]="productForm.invalid"
        >
          Grabar
        </button>
      </mat-card>
    </form>
  </mat-tab>
  <mat-tab label="Otros"></mat-tab>
</mat-tab-group>

<!--
<pre>
  Dirty:
  {{ productForm.dirty }}
</pre>
<pre>
  touched:
  {{ productForm.touched }}
</pre>
<pre>
  Value:
  {{ productForm.value | json }}
</pre>
<pre>
  Status:
  {{ productForm.status }}
</pre>
<pre>
  Valid:
  {{ productForm.valid }}
</pre>
<pre>
  InValid:
  {{ productForm.invalid }}
</pre>
-->
